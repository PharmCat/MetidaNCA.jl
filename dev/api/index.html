<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · MetidaNCA.jl</title><meta name="title" content="API · MetidaNCA.jl"/><meta property="og:title" content="API · MetidaNCA.jl"/><meta property="twitter:title" content="API · MetidaNCA.jl"/><meta name="description" content="Documentation for MetidaNCA.jl."/><meta property="og:description" content="Documentation for MetidaNCA.jl."/><meta property="twitter:description" content="Documentation for MetidaNCA.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MetidaNCA.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../details/">Details</a></li><li><a class="tocitem" href="../parameters/">Parameter list</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Main"><span>Main</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Atomic"><span>Atomic</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PharmCat/MetidaNCA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PharmCat/MetidaNCA.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Main"><a class="docs-heading-anchor" href="#Main">Main</a><a id="Main-1"></a><a class="docs-heading-anchor-permalink" href="#Main" title="Permalink"></a></h2><h3 id="nca!"><a class="docs-heading-anchor" href="#nca!">nca!</a><a id="nca!-1"></a><a class="docs-heading-anchor-permalink" href="#nca!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.nca!" href="#MetidaNCA.nca!"><code>MetidaNCA.nca!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nca!(data::DataSet{Subj}, obs::Union{Symbol, Nothing} = nothing; adm = :ev, calcm = :lint, intpm = nothing, verbose = 0, warn = true, wm::Bool = false, io::IO = stdout, modify! = identity) where Subj &lt;: AbstractSubject</code></pre><p>Non-compartmental (NCA) analysis of PK/PD data.</p><p><strong>Arguments</strong></p><ul><li>data - DataSet to analyze;</li><li>obs - observation to use as a PK metric (by default used first observations vector).</li></ul><p><strong>Keywords</strong></p><ul><li><code>wm</code> - write output to DataSet metadata (<code>:ncalog</code> index).</li></ul><p>Other keywords is the same as in <code>nca!</code> method for <code>PKSubject</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/nca.jl#L467-L482">source</a></section><section><div><pre><code class="language-julia hljs">nca!(data::PKSubject{T,O}, obs::Union{Symbol, Nothing} = nothing; adm = :ev, calcm = :lint,  usedose::Int = 0, intpm = nothing,  partials = nothing, prtext = :err, verbose = 0, warn = true, io::IO = stdout, modify! = nothing) where T where O</code></pre><p><strong>Arguments</strong></p><ul><li>data - PK Subject to analyze;</li><li>obs - observation to use as a PK metric (by default used first observations vector).</li></ul><p><strong>Keywords</strong></p><ul><li><code>adm</code> - administration:<ul><li><code>:ev</code> - extra vascular;</li><li><code>:iv</code> - intravascular bolus;</li></ul></li><li><code>calcm</code> - AUC/AUMC calculation method:<ul><li><code>:lint</code> - linear trapezoidal;</li><li><code>:luld</code> - linear up log down;</li><li><code>:luldt</code> - linear up log down after Tmax;</li><li><code>:logt</code> - log-trapezoidal after Tmax (Not Recommended);</li></ul></li><li><code>usedose</code> - number of dose used for calculation; if <code>usedose = 0</code> (by default) - last dose used.</li><li><code>intpm</code> - interpolation method:<ul><li><code>:lint</code> - linear trapezoidal;</li><li><code>:luld</code> - linear up log down;</li><li><code>:luldt</code> - linear up log down after Tmax;</li><li><code>:logt</code> - log-trapezoidal after Tmax;</li><li><code>:calcm</code> - same as <code>calcm</code>;</li></ul></li><li><code>partials</code> - calculate partial AUC vor vector of time intervals (<code>:err</code> (default) - throw error if end time &gt; last oservation time; <code>:last</code> - no extrapolation; <code>:extr</code> - if <code>Kel</code> calculated used extrapolation or <code>NaN</code> if no <code>Kel</code>);</li><li><code>prtext</code> - extrapolation rule for partials AUC;</li><li><code>verbose</code> - print to <code>io</code>, 1: partial areas table, 2: 1, and results;</li><li><code>warn</code> - show warnings;</li><li><code>io</code> - output stream;</li><li><code>modify!</code> - function to modify output paramaters, call <code>modify!(ncaresult)</code> if difined.</li></ul><p>Results:</p><ul><li>Cmax</li><li>Tmax</li><li>Cdose</li><li>Tlag</li><li>Clast</li><li>AUClast</li><li>AUMClast</li><li>AUCall</li><li>Rsq</li><li>ARsq</li><li>Kel</li><li>HL</li><li>LZint</li><li>NpLZ</li><li>Clast_pred</li><li>AUCinf</li><li>AUCinf_pred</li><li>AUMCinf</li><li>AUMCinf_pred</li><li>AUCpct</li><li>MRTlast</li><li>MRTinf</li><li>MRTinf_pred</li><li>Cllast</li><li>Clinf</li><li>Vzlast</li><li>Vzinf</li><li>Vssinf</li></ul><p>Steady-state parameters (tau used):</p><ul><li>AUCtau</li><li>AUMCtau</li><li>Ctau</li><li>Cavg</li><li>Ctaumax</li><li>Ctaumin</li><li>Accind</li><li>Fluc</li><li>Fluctau</li><li>Swing</li><li>Swingtau</li><li>MRTtauinf</li><li>MRTtauinf_pred</li><li>Cltau</li><li>Vztau</li></ul><p><code>partials</code> is a vector of vectors, tuples or pairs. Example: <code>partials = [(1,2), (3,4)]</code>, <code>partials = [[1,2], (3,4)]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/nca.jl#L505-L588">source</a></section><section><div><pre><code class="language-julia hljs">nca!(data::UPKSubject{T, O, VOL, V}; adm = :ev, calcm = :lint, intpm = nothing, verbose = 0, warn = true, io::IO = stdout, modify! = identity) where T where O where VOL where V</code></pre><p>Non-compartmental (NCA) analysis of pharmacokinetic for urine data.</p><p>Results:</p><ul><li>AUCall</li><li>AUClast</li><li>Rlast</li><li>Maxrate</li><li>Tmax</li><li>AR</li><li>Vol</li><li>Prec</li><li>ARsq</li><li>Rsq</li><li>Kel</li><li>LZ</li><li>LZint</li><li>Rsqn</li><li>HL</li><li>AUCinf</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/nca.jl#L1001-L1024">source</a></section><section><div><pre><code class="language-julia hljs">nca!(data::PDSubject{T,O}; calcm = :lint, intpm = nothing, verbose = 0, warn = true, io::IO = stdout, modify! = identity, kwargs...) where T where O</code></pre><p>Non-compartmental (NCA) analysis of pharmacodynamic data.</p><p>Results:</p><ul><li>Rmax - max responce;</li><li>Tmax - time for maximum responce;</li><li>AUCABL - AUC above baseline;</li><li>AUCBBL - AUC below baseline;</li><li>AUCATH - AUC above threshold;</li><li>AUCBTH - AUC below threshold;</li><li>AUCNETB - AUCABL - AUCBBL;</li><li>AUCNETT - AUCATH - AUCBTH;</li><li>TABL - time above baseline;</li><li>TBBL - time below baseline;</li><li>TATH - time above threshold;</li><li>TBTH - time below threshold;</li><li>AUCBTW - AUC between baseline and threshold;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/nca.jl#L1168-L1189">source</a></section></article><h3 id="nca"><a class="docs-heading-anchor" href="#nca">nca</a><a id="nca-1"></a><a class="docs-heading-anchor-permalink" href="#nca" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.nca" href="#MetidaNCA.nca"><code>MetidaNCA.nca</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nca(args...; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime(), kwargs...)

nca(data, time, obs, sort; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime(), kwargs...)

nca(data, time, obs; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime(), kwargs...)

nca(time, obs; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime(), kwargs...)</code></pre><p>Import data and perform NCA analysis.</p><p>Syntax simillar to <a href="#pkimport"><code>pkimport</code></a></p><p>Applicable <code>kwargs</code> see  <a href="#nca!"><code>nca!</code></a>.</p><p>See also: <a href="#ElimRange"><code>ElimRange</code></a>, <a href="#DoseTime"><code>DoseTime</code></a>, <a href="#LimitRule"><code>LimitRule</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/nca.jl#L438-L454">source</a></section></article><h3 id="pkimport"><a class="docs-heading-anchor" href="#pkimport">pkimport</a><a id="pkimport-1"></a><a class="docs-heading-anchor-permalink" href="#pkimport" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.pkimport" href="#MetidaNCA.pkimport"><code>MetidaNCA.pkimport</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pkimport(data, time, obs, sort;
    kelauto = true,
    elimrange = ElimRange(),
    dosetime = DoseTime(),
    limitrule::Union{Nothing, LimitRule} = nothing,
    warn = true,
    kwargs...)</code></pre><p>Import PK data from table <code>data</code>.</p><ul><li><code>time</code> - time column;</li><li><code>obs</code> - concentration column;</li><li><code>sort</code> - subject sorting columns.</li></ul><p>keywords:</p><ul><li><code>kelauto</code> - if <code>true</code> auto range settings, if <code>false</code> used <code>kelstart</code>/<code>kelend</code> from <code>elimrange</code>;</li><li><code>elimrange</code> - set elimination range settings;</li><li><code>dosetime</code> - set dose and dose time, by default dosetime = 0, dose is <code>NaN</code>;</li><li><code>limitrule</code> - apply limitrule to subject;</li><li><code>warn</code> - false for warnings supress;</li><li>checktime (true) - check uniqueness of time values; </li><li>nutcfunk (last) - function used to chose concentration value for identical time (if checktime == <code>true</code>).</li></ul><div class="admonition is-info" id="Note-17e08b4b16bc53d0"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-17e08b4b16bc53d0" title="Permalink"></a></header><div class="admonition-body"><p>If time column have non-unique values - last pair time-concentration will be used.</p></div></div><p>See also: <a href="#ElimRange"><code>ElimRange</code></a>, <a href="#DoseTime"><code>DoseTime</code></a>, <a href="#LimitRule"><code>LimitRule</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L134-L165">source</a></section><section><div><pre><code class="language-julia hljs">pkimport(data, time, obs;
    warn = true,
    kwargs...)</code></pre><p>Import PK data from tabular data <code>data</code>, <code>time</code> - time column, <code>obs</code> - concentration column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L262-L268">source</a></section><section><div><pre><code class="language-julia hljs">pkimport(time, obs;
    kelauto = true,
    elimrange = ElimRange(),
    dosetime = DoseTime(),
    id = Dict{Symbol, Any}(),
    limitrule::Union{Nothing, LimitRule} = nothing,
    warn = true,
    kwargs...)</code></pre><p>Import PK data from time vector <code>time</code> and concentration vector <code>obs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L289-L301">source</a></section></article><h3 id="upkimport"><a class="docs-heading-anchor" href="#upkimport">upkimport</a><a id="upkimport-1"></a><a class="docs-heading-anchor-permalink" href="#upkimport" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.upkimport" href="#MetidaNCA.upkimport"><code>MetidaNCA.upkimport</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upkimport(data, stime, etime, conc, vol, sort; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime())</code></pre><p>Import urine PK data from table <code>data</code>.</p><ul><li><code>stime</code> - start time column;</li><li><code>etime</code> - end time column;</li><li><code>conc</code> - concentration column;</li><li><code>vol</code> - volume column;</li><li><code>sort</code> - subject sorting columns.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L329-L339">source</a></section><section><div><pre><code class="language-julia hljs">upkimport(data, stime, etime, conc, vol; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime())</code></pre><p>Import single urine PK data from table <code>data</code>.</p><ul><li><code>stime</code> - start time column;</li><li><code>etime</code> - end time column;</li><li><code>conc</code> - concentration column;</li><li><code>vol</code> - volume column.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L378-L387">source</a></section><section><div><pre><code class="language-julia hljs">upkimport(stime, etime, conc, vol; kelauto = true,  elimrange = ElimRange(), dosetime = DoseTime())</code></pre><p>Import urine PK data from time vectors:</p><ul><li><code>stime</code> - start times;</li><li><code>etime</code> - end times;</li><li><code>conc</code> - concentrations;</li><li><code>vol</code> - volumes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L391-L399">source</a></section></article><h3 id="pdimport"><a class="docs-heading-anchor" href="#pdimport">pdimport</a><a id="pdimport-1"></a><a class="docs-heading-anchor-permalink" href="#pdimport" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.pdimport" href="#MetidaNCA.pdimport"><code>MetidaNCA.pdimport</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pdimport(data, time, obs, sort;
    bl = 0,
    th = 0,
    limitrule::Union{Nothing, LimitRule} = nothing,
    warn = true)</code></pre><p>Import pharmackodynamic data from table:</p><ul><li><code>data</code> - data table;</li><li><code>time</code> - observation time;</li><li><code>obs</code> - observation value;</li><li><code>sort</code> - sorting columns.</li></ul><p>Keywords:</p><ul><li><code>bl</code> - baseline;</li><li><code>th</code> - threshold;</li><li><code>limitrule</code> - limit rule;</li><li><code>warn</code> - warning supress if <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L430-L451">source</a></section><section><div><pre><code class="language-julia hljs">pdimport(data, time, obs;
    warn = true,
    kwargs...)</code></pre><p>Import PD data from tabular data <code>data</code>, <code>time</code> - time column, <code>obs</code> - observations column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L510-L516">source</a></section><section><div><pre><code class="language-julia hljs">pdimport(time, obs;
    bl = 0,
    th = 0,
    id = Dict{Symbol, Any}(),
    warn = true)</code></pre><p>Import PD data from time vector <code>time</code> and observations vector <code>obs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/import.jl#L523-L531">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><h3 id="DoseTime"><a class="docs-heading-anchor" href="#DoseTime">DoseTime</a><a id="DoseTime-1"></a><a class="docs-heading-anchor-permalink" href="#DoseTime" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.DoseTime" href="#MetidaNCA.DoseTime"><code>MetidaNCA.DoseTime</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DoseTime(dose::D, time::T, tau::TAU) where D &lt;: Number where T &lt;: Number where TAU &lt;: Number</code></pre><p>Dose settings.</p><ul><li><code>dose</code> - dose;</li><li><code>time</code> - dose time;</li><li><code>tau</code> - tau (τ);</li></ul><p>Dose time set 0 by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/types.jl#L107-L117">source</a></section></article><h3 id="ElimRange"><a class="docs-heading-anchor" href="#ElimRange">ElimRange</a><a id="ElimRange-1"></a><a class="docs-heading-anchor-permalink" href="#ElimRange" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.ElimRange" href="#MetidaNCA.ElimRange"><code>MetidaNCA.ElimRange</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ElimRange(kelstart::T, kelend::T, kelexcl::Vector{T}; time = false)</code></pre><p>Elimination settings for PK subject.</p><ul><li><code>kelstart</code> - start time;</li><li><code>kelend</code> - end time;</li><li><code>kelexcl</code> - excluded values.</li></ul><p>if keyword <code>time == false</code> (by default) - means that the time point number is used to specify start point,  end point and excluded values; <code>time == true</code>  - real time values will be used to declare range and exluded values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/types.jl#L48-L59">source</a></section></article><h3 id="LimitRule"><a class="docs-heading-anchor" href="#LimitRule">LimitRule</a><a id="LimitRule-1"></a><a class="docs-heading-anchor-permalink" href="#LimitRule" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.LimitRule" href="#MetidaNCA.LimitRule"><code>MetidaNCA.LimitRule</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LimitRule(lloq::T, btmax, atmax, nan, rm::Bool) where T &lt;: Real

LimitRule(;lloq = NaN, btmax = NaN, atmax = NaN, nan = NaN, rm::Bool = false)</code></pre><ul><li><code>lloq</code> - LLOQ - low limit of quantification;</li><li><code>btmax</code> - value for points before Tmax;</li><li><code>atmat</code> - values for points after Tmax;</li><li><code>nan</code> - values for replacing <code>NaN</code>;</li><li><code>rm</code> - if <code>true</code>, removee all <code>NaN</code> points.</li></ul><p>Rule for PK subject.</p><ul><li>STEP 1 (NaN step): replace all <code>NaN</code> and <code>missing</code> values with nan keyword value (if <code>nan</code> not NaN);</li><li>STEP 2 (LLOQ step): replace values below <code>lloq</code> with <code>btmax</code> value if this value befor Tmax or with atmax if this value after Tmax (if <code>lloq</code> not NaN);</li><li>STEP 3 (remove NaN): <code>rm</code> == true, then remove all <code>NaN</code> and <code>missing</code> values.</li></ul><p>See also: <a href="#applylimitrule!"><code>applylimitrule!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/types.jl#L277-L295">source</a></section></article><h3 id="MetidaNCA.PKSubject"><a class="docs-heading-anchor" href="#MetidaNCA.PKSubject">MetidaNCA.PKSubject</a><a id="MetidaNCA.PKSubject-1"></a><a class="docs-heading-anchor-permalink" href="#MetidaNCA.PKSubject" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.PKSubject" href="#MetidaNCA.PKSubject"><code>MetidaNCA.PKSubject</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PKSubject(time::Vector{T}, conc::Vector{O}, kelauto::Bool, kelrange::ElimRange, dosetime::DoseTime, keldata::KelData, id::Dict{Symbol, V} = Dict{Symbol, Any}()) where T &lt;: Number where O &lt;: Union{Number, Missing} where V</code></pre><p>Pharmacokinetic subject.</p><p>Fields:</p><ul><li>time::Vector{T} - time values;</li><li>obs::Vector{O} - observations;</li><li>kelauto::Bool </li><li>kelrange::ElimRange</li><li>dosetime::DoseTime</li><li>keldata::KelData</li><li>id::Dict{Symbol, V}</li><li>ncaresobs::Symbol</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/types.jl#L173-L189">source</a></section></article><h3 id="MetidaNCA.NCAResult"><a class="docs-heading-anchor" href="#MetidaNCA.NCAResult">MetidaNCA.NCAResult</a><a id="MetidaNCA.NCAResult-1"></a><a class="docs-heading-anchor-permalink" href="#MetidaNCA.NCAResult" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.NCAResult" href="#MetidaNCA.NCAResult"><code>MetidaNCA.NCAResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NCAResult(subject::T, options, obsname::Symbol, keldata::KD, result::Dict{Symbol, U}) where T &lt;: AbstractSubject where KD where U</code></pre><p>NCA resulst.</p><p>Fields:</p><ul><li>data::T</li><li>options::Dict{Symbol}</li><li>obsname::Symbol</li><li>keldata::Union{KelData, Nothing}</li><li>result::Dict{Symbol, U}</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/types.jl#L245-L257">source</a></section></article><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><h3 id="applylimitrule!"><a class="docs-heading-anchor" href="#applylimitrule!">applylimitrule!</a><a id="applylimitrule!-1"></a><a class="docs-heading-anchor-permalink" href="#applylimitrule!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.applylimitrule!" href="#MetidaNCA.applylimitrule!"><code>MetidaNCA.applylimitrule!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">applylimitrule!(data::Union{PKSubject, PDSubject}, rule::LimitRule)</code></pre><p>Apply rule to PK subject .</p><ul><li>STEP 1 (NaN step): replace all <code>NaN</code> and <code>missing</code> values with nan keyword value (if <code>nan</code> not NaN);</li><li>STEP 2 (LLOQ step): replace values below <code>lloq</code> with <code>btmax</code> value if this value befor Tmax or with atmax if this value after Tmax (if <code>lloq</code> not NaN);</li><li>STEP 3 (remove NaN): <code>rm</code> == true, then remove all <code>NaN</code> and <code>missing</code> values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L2-L10">source</a></section><section><div><pre><code class="language-julia hljs">applylimitrule!(f::Function, data::DataSet{T}, rule::LimitRule) where T &lt;: Union{PKSubject, PDSubject}</code></pre><p>Apply if <code>f(subj)</code> return  <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L15-L19">source</a></section><section><div><pre><code class="language-julia hljs">applylimitrule!(data::DataSet{T}, rule::LimitRule, ind::Int) where T &lt;: Union{PKSubject, PDSubject}</code></pre><p>Apply by ind.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L27-L31">source</a></section><section><div><pre><code class="language-julia hljs">applylimitrule!(data::DataSet{T}, rule::LimitRule, inds::Union{Vector{Int}, UnitRange{Int}, Tuple{Vararg{Int}}}) where T &lt;: Union{PKSubject, PDSubject}</code></pre><p>Apply by inds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L37-L41">source</a></section><section><div><pre><code class="language-julia hljs">applylimitrule!(data::DataSet{T}, rule::LimitRule) where T &lt;: Union{PKSubject, PDSubject}</code></pre><p>Apply to all dataset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L49-L53">source</a></section><section><div><pre><code class="language-julia hljs">applylimitrule!(data::DataSet{T}, rule::LimitRule, sort::Dict) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L61-L63">source</a></section><section><div><pre><code class="language-julia hljs">applylimitrule!(time, obs, rule::LimitRule)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/applylimitrule.jl#L70-L72">source</a></section></article><h3 id="getbl"><a class="docs-heading-anchor" href="#getbl">getbl</a><a id="getbl-1"></a><a class="docs-heading-anchor-permalink" href="#getbl" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.getbl" href="#MetidaNCA.getbl"><code>MetidaNCA.getbl</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getbl(data::T) where T &lt;: PDSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L60-L62">source</a></section></article><h3 id="getdosetime"><a class="docs-heading-anchor" href="#getdosetime">getdosetime</a><a id="getdosetime-1"></a><a class="docs-heading-anchor-permalink" href="#getdosetime" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.getdosetime" href="#MetidaNCA.getdosetime"><code>MetidaNCA.getdosetime</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getdosetime(data::T) where T &lt;: PKSubject</code></pre><p>Return dosetime.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L82-L86">source</a></section></article><h3 id="getkelauto"><a class="docs-heading-anchor" href="#getkelauto">getkelauto</a><a id="getkelauto-1"></a><a class="docs-heading-anchor-permalink" href="#getkelauto" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.getkelauto" href="#MetidaNCA.getkelauto"><code>MetidaNCA.getkelauto</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getkelauto!(data::T) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelauto.jl#L58-L60">source</a></section></article><h3 id="getkelrange"><a class="docs-heading-anchor" href="#getkelrange">getkelrange</a><a id="getkelrange-1"></a><a class="docs-heading-anchor-permalink" href="#getkelrange" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.getkelrange" href="#MetidaNCA.getkelrange"><code>MetidaNCA.getkelrange</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getkelrange(data::T) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelrange.jl#L57-L59">source</a></section></article><h3 id="getkeldata"><a class="docs-heading-anchor" href="#getkeldata">getkeldata</a><a id="getkeldata-1"></a><a class="docs-heading-anchor-permalink" href="#getkeldata" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.getkeldata" href="#MetidaNCA.getkeldata"><code>MetidaNCA.getkeldata</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getkeldata(data::T) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/getkeldata.jl#L4-L6">source</a></section></article><h3 id="getth"><a class="docs-heading-anchor" href="#getth">getth</a><a id="getth-1"></a><a class="docs-heading-anchor-permalink" href="#getth" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.getth" href="#MetidaNCA.getth"><code>MetidaNCA.getth</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getth(data::T) where T &lt;: PDSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L118-L120">source</a></section></article><h3 id="pkplot"><a class="docs-heading-anchor" href="#pkplot">pkplot</a><a id="pkplot-1"></a><a class="docs-heading-anchor-permalink" href="#pkplot" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.pkplot" href="#MetidaNCA.pkplot"><code>MetidaNCA.pkplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pkplot(subj::AbstractSubject; ls = false, elim = false, xticksn = :auto, yticksn = :auto, obsname = nothing, kwargs...)</code></pre><p>Plot for subject</p><ul><li><code>ls</code> - concentration in log scale;</li><li><code>xticksn</code> - number of ticks on x axis;</li><li><code>yticksn</code> - number of ticks on y axis;</li></ul><p><em>Other keywords:</em></p><ul><li><code>plotstyle</code> - predefined plot style from PKPLOTSTYLE;</li><li><code>drawbl</code> (<code>false</code>) - draw baseline, only for PDSubject;</li><li><code>drawth</code> (<code>false</code>) - draw threshold, only for PDSubject;</li><li><code>drawdt</code> (<code>false</code>) - draw drawdose time;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/plots.jl#L272-L288">source</a></section><section><div><pre><code class="language-julia hljs">pkplot(data::DataSet{T};
typesort::Union{Nothing, Symbol, AbstractVector{Symbol}} = nothing,
pagesort::Union{Nothing, Symbol, AbstractVector{Symbol}, NoPageSort} = nothing,
filter::Union{Nothing, Dict{Symbol}} = nothing,
uylims::Bool = false,
ldict = nothing,
savepath::Union{Nothing, AbstractString} = nothing,
namepref::Union{Nothing, AbstractString} = nothing,
onlyplots = false,
kwargs...) where T &lt;: AbstractSubject</code></pre><p>PK plot for subject set.</p><ul><li><code>typesort</code> - sort on page by this id key;</li><li><code>pagesort</code> - different pages by this id key;</li><li><code>filter</code> - use only subjects if filter ⊆ subject id;</li><li><code>uylims</code> - same ylims for all dataset;</li><li><code>ldict</code> - Dict with labels for replace;</li><li><code>savepath</code> - path for plot saving;</li><li><code>namepref</code> - name prefix for saving files.</li><li><code>onlyplots</code> - if <code>true</code> return only vetor of plots;</li></ul><p>Use <code>pagesort = MetidaNCA.NoPageSort()</code> to prevent page plotting (return single plot).</p><p>Return vector of pairs: <code>Page ID</code> =&gt; <code>Plot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/plots.jl#L412-L438">source</a></section><section><div><pre><code class="language-julia hljs">pkplot(data::DataSet{T}; elim = false, kelexcl = true, kelpoints = true, kwargs...) where T &lt;: NCAResult</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/plots.jl#L556-L558">source</a></section><section><div><pre><code class="language-julia hljs">pkplot(data::NCAResult; elim = false, kelexcl = true, kelpoints = true, kwargs...)</code></pre><p>Plot PK profile with elmination results.</p><ul><li><code>elim</code> - draw elimination curve;</li><li><code>kelexcl</code> - draw exclusions;</li><li><code>kelpoints</code> - draw points for elimination calculation;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/plots.jl#L579-L587">source</a></section></article><h3 id="vpcplot"><a class="docs-heading-anchor" href="#vpcplot">vpcplot</a><a id="vpcplot-1"></a><a class="docs-heading-anchor-permalink" href="#vpcplot" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.vpcplot" href="#MetidaNCA.vpcplot"><code>MetidaNCA.vpcplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vpcplot(data::DataSet{T}; timef = identity, meanf = mean, intf = x-&gt;qf(x, 0.05), kwargs...) where T &lt;: Union{PKSubject, PDSubject}</code></pre><p>Plot means in each time point with 0.05 - 0.95 quantile area.</p><p><code>timef</code> - Function, can be used to transform time points.</p><p><code>meanf</code> - <code>mean</code> by default, any other statistic function can be used.</p><p><code>intf</code> - function to calculate upper and lower bounds for each time point, by default used:</p><pre><code class="nohighlight hljs">qf(x, alpha) = (quantile(x, alpha), quantile(x, 1-alpha))</code></pre><p>Any other keywords pass to <code>plot</code> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/plots.jl#L604-L620">source</a></section></article><h3 id="setbl!"><a class="docs-heading-anchor" href="#setbl!">setbl!</a><a id="setbl!-1"></a><a class="docs-heading-anchor-permalink" href="#setbl!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.setbl!" href="#MetidaNCA.setbl!"><code>MetidaNCA.setbl!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setbl!(data::T, bl) where T &lt;: PDSubject</code></pre><p>Set <code>baseline</code> for pd subject <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L3-L7">source</a></section><section><div><pre><code class="language-julia hljs">setbl!(data::DataSet{T}, bl, ind::Int) where T &lt;: PDSubject</code></pre><p>Set baseline for subject <code>ind</code> in <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L14-L18">source</a></section><section><div><pre><code class="language-julia hljs">setbl!(data::DataSet{T}, bl, inds::Union{Vector{Int}, UnitRange{Int}, Tuple{Vararg{Int}}})</code></pre><p>Set baseline for all subjects in range or vector <code>ind</code> in <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L24-L28">source</a></section><section><div><pre><code class="language-julia hljs">setbl!(data::DataSet{T}, bl) where T &lt;: PDSubject</code></pre><p>Set <code>baseline</code> for all subjects in <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L36-L40">source</a></section><section><div><pre><code class="language-julia hljs">setbl!(data::DataSet{T}, bl, sort::Dict) where T &lt;: PDSubject</code></pre><p>Set <code>baseline</code> only for subjects which <code>sort</code> ⊆ <code>id</code> is <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L48-L52">source</a></section></article><h3 id="setdosetime!"><a class="docs-heading-anchor" href="#setdosetime!">setdosetime!</a><a id="setdosetime!-1"></a><a class="docs-heading-anchor-permalink" href="#setdosetime!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.setdosetime!" href="#MetidaNCA.setdosetime!"><code>MetidaNCA.setdosetime!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setdosetime!(data::AbstractSubject, dosetime)</code></pre><p>Set dose time <code>dosetime</code> for subject <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">setdosetime!(data::PKSubject, dosetime::AbstractVector{&lt;:DoseTime})</code></pre><p>Set dose time <code>dosetime</code> for subject <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L14-L18">source</a></section><section><div><pre><code class="language-julia hljs">setdosetime!(data::PKSubject, dosetime::DoseTime)</code></pre><p>Set dose time <code>dosetime</code> for subject <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L25-L29">source</a></section><section><div><pre><code class="language-julia hljs">setdosetime!(data::DataSet{T}, dosetime::DoseTime, ind::Int) where T &lt;: AbstractSubject</code></pre><ul><li><code>ind</code> - index in DataSet.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L36-L40">source</a></section><section><div><pre><code class="language-julia hljs">setdosetime!(data::DataSet{T}, dosetime::DoseTime, inds::Union{Vector{Int}, UnitRange{Int}, Tuple{Vararg{Int}}}) where T &lt;: PKSubject</code></pre><ul><li><code>inds</code> - indexes in DataSet.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L46-L50">source</a></section><section><div><pre><code class="language-julia hljs">setdosetime!(data::DataSet{T}, dosetime::DoseTime) where T &lt;: AbstractSubject</code></pre><p>For all subjects in DataSet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L58-L62">source</a></section><section><div><pre><code class="language-julia hljs">setdosetime!(data::DataSet{T}, dosetime::DoseTime, sort::Dict) where T &lt;: AbstractSubject</code></pre><p>Set dose time <code>dosetime</code> for subjects if <code>sort</code> ⊆ subject&#39;s <code>id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setdosetime.jl#L70-L74">source</a></section></article><h3 id="setkelauto!"><a class="docs-heading-anchor" href="#setkelauto!">setkelauto!</a><a id="setkelauto!-1"></a><a class="docs-heading-anchor-permalink" href="#setkelauto!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.setkelauto!" href="#MetidaNCA.setkelauto!"><code>MetidaNCA.setkelauto!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setkelauto!(data::T, kelauto::Bool) where T &lt;: PKSubject</code></pre><p>Set range for elimination parameters calculation for subject.</p><ul><li><code>data</code>     - PK subject;</li><li><code>kelauto</code>  - value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelauto.jl#L2-L9">source</a></section><section><div><pre><code class="language-julia hljs">setkelauto!(data::DataSet{T}, kelauto::Bool, ind::Int) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelauto.jl#L19-L21">source</a></section><section><div><pre><code class="language-julia hljs">setkelauto!(data::DataSet{T}, kelauto::Bool, inds::Union{Vector{Int}, UnitRange{Int}, Tuple{Vararg{Int}}}) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelauto.jl#L27-L29">source</a></section><section><div><pre><code class="language-julia hljs">setkelauto!(data::DataSet{T}, kelauto::Bool) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelauto.jl#L37-L39">source</a></section><section><div><pre><code class="language-julia hljs">setkelauto!(data::DataSet{T}, kelauto::Bool, sort::Dict) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelauto.jl#L47-L49">source</a></section></article><h3 id="setkelrange!"><a class="docs-heading-anchor" href="#setkelrange!">setkelrange!</a><a id="setkelrange!-1"></a><a class="docs-heading-anchor-permalink" href="#setkelrange!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.setkelrange!" href="#MetidaNCA.setkelrange!"><code>MetidaNCA.setkelrange!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setkelrange!(data::T, range::ElimRange; kelauto = false) where T &lt;: PKSubject</code></pre><p>Set <code>range</code> for subject <code>data</code>. Set <code>kelauto</code> if possible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelrange.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">setkelrange!(data::DataSet{T}, range::ElimRange, ind::Int; kelauto = false) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelrange.jl#L19-L21">source</a></section><section><div><pre><code class="language-julia hljs">setkelrange!(data::DataSet{T}, range::ElimRange, inds::Union{Vector{Int}, UnitRange{Int}, Tuple{Vararg{Int}}}; kelauto = false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelrange.jl#L27-L29">source</a></section><section><div><pre><code class="language-julia hljs">setkelrange!(data::DataSet{T}, range::ElimRange; kelauto = false) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelrange.jl#L37-L39">source</a></section><section><div><pre><code class="language-julia hljs">setkelrange!(data::DataSet{T}, range::ElimRange, sort::Dict; kelauto = false) where T &lt;: PKSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setkelrange.jl#L47-L49">source</a></section></article><h3 id="setth!"><a class="docs-heading-anchor" href="#setth!">setth!</a><a id="setth!-1"></a><a class="docs-heading-anchor-permalink" href="#setth!" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.setth!" href="#MetidaNCA.setth!"><code>MetidaNCA.setth!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setth!(data::T, th) where T &lt;: PDSubject</code></pre><p>Set <code>threshold</code> for subject <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L69-L73">source</a></section><section><div><pre><code class="language-julia hljs">setth!(data::DataSet{T}, th, ind::Int) where T &lt;: PDSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L80-L82">source</a></section><section><div><pre><code class="language-julia hljs">setth!(data::DataSet{T}, th, inds::Union{Vector{Int}, UnitRange{Int}, Tuple{Vararg{Int}}})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L88-L90">source</a></section><section><div><pre><code class="language-julia hljs">setth!(data::DataSet{T}, th) where T &lt;: PDSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L98-L100">source</a></section><section><div><pre><code class="language-julia hljs">setth!(data::DataSet{T}, th, sort::Dict) where T &lt;: PDSubject</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/setblth.jl#L108-L110">source</a></section></article><h3 id="timefilter"><a class="docs-heading-anchor" href="#timefilter">timefilter</a><a id="timefilter-1"></a><a class="docs-heading-anchor-permalink" href="#timefilter" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.timefilter" href="#MetidaNCA.timefilter"><code>MetidaNCA.timefilter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">timefilter(subj::PKSubject, time::AbstractRange)</code></pre><p>Exclude all observation than not in time range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/timefilter.jl#L2-L6">source</a></section><section><div><pre><code class="language-julia hljs">timefilter(subj::PKSubject, time::Tuple{&lt;:Number, &lt;:Number})</code></pre><p>Make deepcopy of subj and remove all observations &lt; time[1] or &gt; time[2]. Then resize keldata to 0.</p><p>If any of points in elimination rage not in min/max time, then elimination settings reset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/timefilter.jl#L29-L35">source</a></section><section><div><pre><code class="language-julia hljs">timefilter(data::DataSet{&lt;: PKSubject}, time)</code></pre><p>Make new DataSet with new filtered subjects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/timefilter.jl#L39-L43">source</a></section></article><h2 id="Atomic"><a class="docs-heading-anchor" href="#Atomic">Atomic</a><a id="Atomic-1"></a><a class="docs-heading-anchor-permalink" href="#Atomic" title="Permalink"></a></h2><h3 id="auc_sparse"><a class="docs-heading-anchor" href="#auc_sparse">auc_sparse</a><a id="auc_sparse-1"></a><a class="docs-heading-anchor-permalink" href="#auc_sparse" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.auc_sparse" href="#MetidaNCA.auc_sparse"><code>MetidaNCA.auc_sparse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">auc_sparse(time, obs)</code></pre><p>AUC for sparse data.</p><p class="math-container">\[w_1 = (t_2 - t_1) / 2\]</p><p class="math-container">\[w_j = (t_{j+1} - t_{j-1}) / 2  (2 \leq j \leq J - 1)\]</p><p class="math-container">\[w_J = (t_J - t_{J-1}) / 2\]</p><p class="math-container">\[AUC = \sum_{j=1}^J \mu_j w_j\]</p><p>where <code>math \mu_j</code> is the mean drug concentration at time t.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/sparse.jl#L1-L23">source</a></section></article><blockquote><p><strong>Warning</strong> Atomic functions: <code>cmax</code>, <code>tmax</code>, <code>auc</code> not exported, use <code>import MetidaNCA: cmax, tmax, auc;</code>.</p></blockquote><h3 id="auc"><a class="docs-heading-anchor" href="#auc">auc</a><a id="auc-1"></a><a class="docs-heading-anchor-permalink" href="#auc" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.auc" href="#MetidaNCA.auc"><code>MetidaNCA.auc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">auc(time::AbstractVector, obs::AbstractVector;  calcm = :lint)</code></pre><p>Return AUC. All concentration points included in calculation.</p><ul><li><code>calcm</code> - AUC/AUMC calculation method:<ul><li><code>:lint</code> - linear trapezoidal;</li><li><code>:logt</code> - log-trapezoidal after Tmax;</li><li><code>:luld</code> - linar up log down;</li><li><code>:luldt</code> - linear up log down after Tmax;</li></ul></li></ul><div class="admonition is-info" id="Note-6e3c2e6c300a6d8f"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-6e3c2e6c300a6d8f" title="Permalink"></a></header><div class="admonition-body"><p>This function doesn&#39;t contain <code>NaN</code>, <code>missing</code> or dosing time checks.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/atomic.jl#L25-L39">source</a></section></article><h3 id="cmax"><a class="docs-heading-anchor" href="#cmax">cmax</a><a id="cmax-1"></a><a class="docs-heading-anchor-permalink" href="#cmax" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.cmax" href="#MetidaNCA.cmax"><code>MetidaNCA.cmax</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cmax(time::AbstractVector, obs::AbstractVector)</code></pre><p>Return Cmax</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/atomic.jl#L3-L7">source</a></section></article><h3 id="tmax"><a class="docs-heading-anchor" href="#tmax">tmax</a><a id="tmax-1"></a><a class="docs-heading-anchor-permalink" href="#tmax" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetidaNCA.tmax" href="#MetidaNCA.tmax"><code>MetidaNCA.tmax</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tmax(time::AbstractVector, obs::AbstractVector)</code></pre><p>Return Tmax</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PharmCat/MetidaNCA.jl/blob/dc283fa4fd20194d375adce7a19759e16437b654/src/atomic.jl#L14-L18">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parameters/">« Parameter list</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Wednesday 2 July 2025 19:55">Wednesday 2 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
